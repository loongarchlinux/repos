# Maintainer: Caleb Maclennan <caleb@alerque.com>
# Contributor: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Christoph Drexler <chrdr at gmx dot at>

pkgname=leptonica
pkgver=1.84.0
pkgrel=1
pkgdesc='Software that is broadly useful for image processing and image analysis applications'
arch=(loong64 x86_64)
url='http://www.leptonica.com'
_url="https://github.com/DanBloomberg/$pkgname"
license=(custom)
depends=(giflib libgif.so
         libjpeg-turbo libjpeg.so
         libpng libpng16.so
         libtiff libtiff.so
         libtiff libtiff.so
         libwebp libwebp.so libwebpmux.so libsharpyuv.so
         openjpeg2 # libopenjp2.so
         zlib libz.so)
_archive="$pkgname-$pkgver"
source=("$_url/archive/$pkgver/$_archive.tar.gz")
sha256sums=('440e6bb1b11e385310b31fab2505c9b0e0835a42f2fc985c2f79c81a8684ff98')

prepare() {
  cd "$_archive"
  ./autogen.sh
}

build() {
  cd "$_archive"
  ./configure --prefix=/usr
  make
}

package() {
  cd "$_archive"
  make DESTDIR="$pkgdir" install
  install -Dm066 -t "$pkgdir/usr/share/licenses/leptonica/" leptonica-license.txt
}
