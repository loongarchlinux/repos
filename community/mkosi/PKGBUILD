# Maintainer: Christian Rebischke <chris.rebischke@archlinux.org>
# Maintainer: Lucas Werkmeister <mail@lucaswerkmeister.de>
# Contributor: Dave Reisner <dreisner@archlinux.org>

pkgname=mkosi
pkgver=5
pkgrel=2
pkgdesc='Build Legacy-Free OS Images'
arch=('any')
url='https://github.com/systemd/mkosi'
license=('LGPL2.1')
depends=('python')
makedepends=('python-setuptools')
optdepends=('debootstrap: build Debian or Ubuntu images'
            'debian-archive-keyring: build Debian images'
            'ubuntu-keyring: build Ubuntu images'
            'arch-install-scripts: build Arch images'
            'gnupg: sign images'
            'xz: compress images with xz'
            'btrfs-progs: raw_btrfs and subvolume output formats'
            'dosfstools: build bootable images'
            'squashfs-tools: raw_squashfs output format'
            'tar: tar output format'
            'cryptsetup: add dm-verity partitions'
            'edk2-ovmf: run bootable images in QEMU'
            'qemu: run bootable images in QEMU'
            'sbsigntools: sign EFI binaries for UEFI SecureBoot')
source=("${pkgname}-${pkgver}.tar.gz::https://github.com/systemd/mkosi/archive/v$pkgver.tar.gz")
sha512sums=('cebb0f50b57a3285b4bb1301890436551c6931516e8c60a36c44ddc4c53f232178e1f56aa8c538dad2d12ce54e304b457d046bc0df6ac6d2a226a7b5fdbd1f36')

package() {
  cd "mkosi-$pkgver"
  python setup.py install --root="$pkgdir"
}
